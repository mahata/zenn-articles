---
title: "Oracle Cloud ã§å®Ÿé¨“çš„ãª Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ç„¡æ–™ã§æ§‹ç¯‰ã™ã‚‹æ–¹æ³•"
emoji: "ğŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Kubernetes", "k8s", "OCI"]
published: true
---

[Oracle Cloud ã«ã¯éå¸¸ã«å¯›å®¹ãªç„¡æ–™æ ãŒã‚ã‚Š](https://docs.oracle.com/ja-jp/iaas/Content/FreeTier/freetier_topic-Always_Free_Resources.htm)ã€ãŸã¨ãˆã°æ¬¡ã®ã‚ˆã†ãªæ§‹æˆã® Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

* **ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³**: 2 COPU & ãƒ¡ãƒ¢ãƒª 12 GB
* **ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰1**: 1 OCPU & ãƒ¡ãƒ¢ãƒª 6 GB
* **ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰2**: 1 OCPU & ãƒ¡ãƒ¢ãƒª 6 GB

ã“ã®ã‚¹ãƒšãƒƒã‚¯ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ¬¡ã®éƒ¨åˆ†ã‹ã‚‰æ¥ã¦ã„ã¾ã™ã€‚

> ã™ã¹ã¦ã®ãƒ†ãƒŠãƒ³ã‚·ã¯ã€Armãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’å«ã‚€VM.Standard.A1.Flexã‚·ã‚§ã‚¤ãƒ—ã‚’ä½¿ç”¨ã™ã‚‹VMã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å¯¾ã—ã¦ã€æœˆã”ã¨ã«æœ€åˆã®3,000 OCPUæ™‚é–“ãŠã‚ˆã³18,000 GBæ™‚é–“ã‚’ç„¡æ–™ã§å–å¾—ã—ã¾ã™ã€‚**Always Free ãƒ†ãƒŠãƒ³ã‚·ã®å ´åˆã€ã“ã‚Œã¯4 OCPUãŠã‚ˆã³24 GBã®ãƒ¡ãƒ¢ãƒªãƒ¼ã¨åŒç­‰ã§ã™**ã€‚


ã“ã®è¨˜äº‹ã§ã¯å®Ÿé¨“çš„ãª Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ Oracle Cloud ã«æ§‹ç¯‰ã™ã‚‹æ‰‹é †ã«ã¤ã„ã¦æ‰±ã„ã¾ã™ã€‚ãªãŠã€å…ˆè¡Œäº‹ä¾‹ã¯ã™ã§ã«ã„ãã¤ã‹ã‚ã‚Šã€åƒ•è‡ªèº«ã‚‚ã€Œ[Oracle Cloudã®ç„¡æ–™æ ã§Kubernetesã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ§‹ç¯‰ã™ã‚‹(å®Œå…¨ç‰ˆ) | blog.potproject.net](https://blog.potproject.net/2021/06/01/oracle-cloud-kubernetes)ã€ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚ç‰¹ã« iptables ã®è¨­å®šã¯ãã®ã¾ã¾ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ä¸»ãªé•ã„ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚

1. ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹ç’°å¢ƒæ§‹ç¯‰ã®è‡ªå‹•åŒ–
2. Oracle Cloud ã®ã€Œä»®æƒ³ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ã®è¨­å®š

ãã‚Œã§ã¯å…·ä½“çš„ãªæ§‹ç¯‰æ–¹æ³•ã«é€²ã¿ã¾ã—ã‚‡ã†ã€‚

## Oracle Cloud ã§ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ãƒˆã®è¨­å®š

Oracle Cloud ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ã§ãã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚ã€Œã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒˆãƒ»ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä½œæˆã€ã‹ã‚‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ã»ã¨ã‚“ã©å›°ã‚‹ã“ã¨ã¯ãªã„ã¨æ€ã„ã¾ã™ãŒã€Œã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã‚·ã‚§ã‚¤ãƒ—ã€ã ã‘ã¯æ¬¡ã®ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

![](/images/oracle-cloud/ubuntu20.04-ampere.png)

ã€ŒCanonical Ubuntu 20.04ã€ã¯ Kubernetes ã‚’ 20.04 ã§å‹•ã‹ã—ãŸã„ã‹ã‚‰ã§ã€`A1.Flex` ã¯ Oracle Cloud ã‚’ç„¡æ–™ã§ä½¿ã†ãŸã‚ã§ã™ã€‚

ã¾ãŸã€ã‚¤ãƒ³ã‚°ãƒ¬ã‚¹ãƒ»ãƒ«ãƒ¼ãƒ«ã«æ¬¡ã®è¨±å¯ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ Kubernetes ãƒãƒ¼ãƒ‰åŒå£«ãŒé€šä¿¡ã‚’ã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚

![](/images/oracle-cloud/ingress-rules.png)

## iptables ã¸ã®è¨­å®šè¿½åŠ 

Kuberentes ãƒãƒ¼ãƒ‰é–“ã§é€šä¿¡ã§ãã‚‹ã‚ˆã†ã« `iptables` ã®è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚

Oracle Cloud ã§ Ubuntu 20.04 ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€[ã“ã® Gist ã®å†…å®¹](https://gist.github.com/mahata/856b769952bf3f0a3d70abe7ae16a217)ã§ `/etc/iptables/rules.v4` ã‚’ç½®ãæ›ãˆã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ `iptables` ã‚’æ›´æ–°ã—ã¾ã™ã€‚

```
sudo iptables-restore < /etc/iptables/rules.v4
```

## Oracle Cloud ã§ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã¨ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã§åˆ¥ã€…ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

* [ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³å‘ã‘ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](https://gist.github.com/mahata/e8d1ce5c188b6f3d91d98d83459b0c90#file-install_master-sh)
* [ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰å‘ã‘ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](https://gist.github.com/mahata/e8d1ce5c188b6f3d91d98d83459b0c90#file-install_worker-sh)

ã“ã‚Œã‚‰ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€å…ƒã€… [Kim Wuestkamp](https://github.com/wuestkamp) ã•ã‚“ãŒ [Udemy ã§é–‹å‚¬ã—ã¦ã„ã‚‹ CKS å­¦ç¿’è€…å‘ã‘ã‚³ãƒ¼ã‚¹](https://www.udemy.com/course/certified-kubernetes-security-specialist/)ã§[é…å¸ƒã—ã¦ã„ã‚‹ã‚‚ã®](https://github.com/killer-sh/cks-course-environment/tree/master/cluster-setup/latest)ã§ã™ã€‚ã“ã‚Œã‚‰ã¯ GCP ã§ã®ç’°å¢ƒæ§‹ç¯‰ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ãŒã€ã“ã“ã§ã¯ Oracle Cloud ã§ Arm ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€å°‘ã—å¤‰æ›´ã‚’åŠ ãˆã¦ã„ã¾ã™ã€‚

å…·ä½“çš„ã«ã¯ `containerd` ã‚’ Arm å‘ã‘ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Š `containerd-1.6.12-linux-amd64.tar.gz` ã‚’ `containerd-1.6.12-linux-arm64.tar.gz` ã«æ›¸ãæ›ãˆã¦ã„ã¾ã™ã€‚

ã¾ãšã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã§ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æœ€å¾Œã«ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ãŒ Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ã«å‚åŠ ã™ã‚‹éš›ã«å¿…è¦ãªã‚³ãƒãƒ³ãƒ‰ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚ãƒ¡ãƒ¢ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

```
$ sudo -i
# bash install_master.sh
...
### COMMAND TO ADD A WORKER NODE ###
kubeadm join 10.0.0.162:6443 --token xxxxxx.xxxxxxxxxxxxxxxx --discovery-token-ca-cert-hash sha256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

æ¬¡ã«ã€ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã§ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ãã®å¾Œã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã§ã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œæ™‚ã«å¾—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä½¿ã„ã€æ¬¡ã®ã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```
$ sudo -i
# bash install_worker.sh
...

# kubeadm join 10.0.0.162:6443 --token xxxxxx.xxxxxxxxxxxxxxxx --discovery-token-ca-cert-hash sha256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
[preflight] Running pre-flight checks
[preflight] Reading configuration from the cluster...
[preflight] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -o yaml'
[kubelet-start] Writing kubelet configuration to file "/var/lib/kubelet/config.yaml"
[kubelet-start] Writing kubelet environment file with flags to file "/var/lib/kubelet/kubeadm-flags.env"
[kubelet-start] Starting the kubelet
[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...

This node has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run 'kubectl get nodes' on the control-plane to see this node join the cluster.
```

ã“ã“ã¾ã§ã®è¨­å®šã‚’çµ‚ãˆã‚‹ã¨ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ—ãƒ¬ãƒ¼ãƒ³ã§ `kubectl get node` ãªã©ã‚’å®Ÿè¡Œã—ã¦ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒ‰ã‚’å«ã‚€ Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ãŒã§ãã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ã€‚

```
# kubectl get node
NAME    STATUS   ROLES           AGE     VERSION
node1   Ready    control-plane   8m45s   v1.26.1
node2   Ready    <none>          77s     v1.26.1
```

## DNS ã®è¨­å®š

ã¾ã  Pod åŒå£«ãŒé€šä¿¡ã‚’ã™ã‚‹ãŸã‚ã«ã¯å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ãŸã¨ãˆã° `frontend` Pod ã¨ `backend` Pod ãŒ `default` ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã«å­˜åœ¨ã™ã‚‹ã¨ãã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã¯å¤±æ•—ã—ã¾ã™ã€‚

```
$ kubectl exec backend -- curl frontend
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:--  0:00:19 --:--:--     0
curl: (6) Could not resolve host: frontend
command terminated with exit code 6
```

`frontend` ã¨ã„ã†åå‰ãŒè§£æ±ºã§ãã¦ã„ãªã„ã“ã¨ã‹ã‚‰ `CoreDNS` ã®å•é¡Œã§ã¯ãªã„ã‹ã¨ã‚ãŸã‚Šã‚’ã¤ã‘ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªã§ãã¾ã™ã€‚

```
$ kubectl logs -n kube-system -l k8s-app=kube-dns
...
[ERROR] plugin/errors: 2 3656038324237740050.970672069479610665. HINFO: read udp 192.168.0.4:34296->169.254.169.254:53: read: no route to host
[ERROR] plugin/errors: 2 3656038324237740050.970672069479610665. HINFO: read udp 192.168.0.4:56195->169.254.169.254:53: read: no route to host
```

ã“ã“ã§ `169.254.169.254:53` ã¯ `CoreDNS` ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆå…ˆã§ã‚ã‚Šã€[ã“ã‚Œã¯ Oracle Cloud ã®ãƒªã‚¾ãƒ«ãƒã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã™](https://docs.oracle.com/ja-jp/iaas/Content/Network/Concepts/dns.htm)ã€‚

`CoreDNS` ã® ConfigMap ã‚’ç¢ºèªã—ã¾ã™ã€‚

:::details CoreDNS ã® ConfigMap

```
$ kubectl get configmap -n kube-system coredns -o yaml
apiVersion: v1
data:
  Corefile: |
    .:53 {
        errors
        health {
           lameduck 5s
        }
        ready
        kubernetes cluster.local in-addr.arpa ip6.arpa {
           pods insecure
           fallthrough in-addr.arpa ip6.arpa
           ttl 30
        }
        prometheus :9153
        forward . /etc/resolv.conf {
           max_concurrent 1000
        }
        cache 30
        loop
        reload
        loadbalance
    }
kind: ConfigMap
metadata:
  creationTimestamp: "2023-04-11T13:55:15Z"
  name: coredns
  namespace: kube-system
  resourceVersion: "218"
  uid: 31ccd15e-3073-4af3-92e7-57ad21596c7d
```

:::

æ¬¡ã®ç®‡æ‰€ã‹ã‚‰ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ã® `/etc/resolv.conf` ã‚’å‚ç…§ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚ 

```
forward . /etc/resolv.conf {
   max_concurrent 1000
}
```

æ¬¡ã«ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ã® `/etc/resolv.conf` ã®ä¸­èº«ã‚’ç¢ºèªã—ã¾ã™ã€‚

:::details /etc/resolv.conf

```
# This file is managed by man:systemd-resolved(8). Do not edit.
#
# This is a dynamic resolv.conf file for connecting local clients to the
# internal DNS stub resolver of systemd-resolved. This file lists all
# configured search domains.
#
# Run "resolvectl status" to see details about the uplink DNS servers
# currently in use.
#
# Third party programs must not access this file directly, but only through the
# symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a different way,
# replace this symlink by a static file or a different symlink.
#
# See man:systemd-resolved.service(8) for details about the supported modes of
# operation for /etc/resolv.conf.

nameserver 127.0.0.53
options edns0 trust-ad
search vcn04192235.oraclevcn.com
```

:::

ã„ã‚ãã€`/etc/resolv.conf` ã¯è‡ªå‹•ã§ç”Ÿæˆã•ã‚ŒãŸã‚‚ã®ãªã®ã§ "uplink DNS server" ã®ä¸­èº«ã¯ `resolvectl status` ã§ç¢ºèªã›ã‚ˆã€ã¨ã®ã“ã¨ã§ã—ãŸã€‚

:::details `resolvectl status` ã®çµæœ

```
Global
       LLMNR setting: no
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no
          DNSSEC NTA: 10.in-addr.arpa
                      16.172.in-addr.arpa
                      168.192.in-addr.arpa
                      17.172.in-addr.arpa
                      18.172.in-addr.arpa
                      19.172.in-addr.arpa
                      20.172.in-addr.arpa
                      21.172.in-addr.arpa
                      22.172.in-addr.arpa
                      23.172.in-addr.arpa
                      24.172.in-addr.arpa
                      25.172.in-addr.arpa
                      26.172.in-addr.arpa
                      27.172.in-addr.arpa
                      28.172.in-addr.arpa
                      29.172.in-addr.arpa
                      30.172.in-addr.arpa
                      31.172.in-addr.arpa
                      corp
                      d.f.ip6.arpa
                      home
                      internal
                      intranet
                      lan
                      local
                      private
                      test

Link 14 (calia622272a21e)
      Current Scopes: none
DefaultRoute setting: no
       LLMNR setting: yes
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no

Link 13 (cali0d901d3d613)
      Current Scopes: none
DefaultRoute setting: no
       LLMNR setting: yes
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no

Link 12 (cali1e9261921dc)
      Current Scopes: none
DefaultRoute setting: no
       LLMNR setting: yes
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no

Link 11 (cali9b723216629)
      Current Scopes: none
DefaultRoute setting: no
       LLMNR setting: yes
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no

Link 6 (flannel.1)
      Current Scopes: none
DefaultRoute setting: no
       LLMNR setting: yes
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no

Link 3 (docker0)
      Current Scopes: none
DefaultRoute setting: no
       LLMNR setting: yes
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no

Link 2 (enp0s6)
      Current Scopes: DNS
DefaultRoute setting: yes
       LLMNR setting: yes
MulticastDNS setting: no
  DNSOverTLS setting: no
      DNSSEC setting: no
    DNSSEC supported: no
  Current DNS Server: 169.254.169.254
         DNS Servers: 169.254.169.254
          DNS Domain: vcn04192235.oraclevcn.com
```
:::

ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã§ã€Œ`Global` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« `DNS Server: 169.254.169.254` ãŒå­˜åœ¨ã—ãªã„ã®ã¯ãŠã‹ã—ã„ã€ã¨æ€ã„ã€`/etc/systemd/resolved.conf` ã«æ¬¡ã®å†…å®¹ã‚’è¿½è¨˜ã—ã¾ã—ãŸã€‚

```
[Resolve]
DNS=169.254.169.254
```

ãã®å¾Œ `systemctl restart systemd-resolved` ã‚’å®Ÿè¡Œã—ãŸã¨ã“ã‚ã€`Global` ã« `DNS Server: 169.254.169.254` ãŒè¿½åŠ ã•ã‚Œã€Pod åŒå£«ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚å–ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## æ®‹ã‚‹è¬

ãã‚‚ãã‚‚ `kube-dns` ã®ãƒ­ã‚°ã§ã¯ `169.254.169.254:53` ã«åˆ°é”ã§ããªã„ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã§ã—ãŸã€‚ã—ã‹ã—ã€ã“ã“ã§ã¯ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒ‰ã® DNS Server ã« `169.254.169.254` ã‚’è¿½åŠ ã—ãŸã ã‘ã§ã€ãã“ã¸ã®åˆ°é”æ€§ã«ã¤ã„ã¦æ‰‹ã‚’åŠ ãˆã¦ã„ãªã„ã®ã«ã€é€šä¿¡ã§ãã¦ã—ã¾ã„ã¾ã—ãŸã€‚

ã‚¯ãƒ©ã‚¹ã‚¿ã‚’å†åº¦ä½œã‚‹ã¨ãã«ã¯ã‚‚ã†å°‘ã—èª¿ã¹ã¦ã¿ã‚ˆã†ã¨æ€ã£ã¦ã„ã¾ã™ã€‚
