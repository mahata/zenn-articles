---
title: "Next.js (ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 13.4) + TypeScript ã®æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºç’°å¢ƒè¨­å®š"
emoji: "ğŸš…"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["nextjs", "typescript"]
published: true
---

## ã“ã®è¨˜äº‹ã¯ä½•ã§ã™ã‹?

`Next.js` ã®æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç’°å¢ƒè¨­å®šã«é–¢ã™ã‚‹ãƒ¡ãƒ¢ã§ã™ã€‚

## `create-next-app` ã§ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œã‚‹

[å…¬å¼ã‚µã‚¤ãƒˆãŒå‹§ã‚ã‚‹é€šã‚Š](https://nextjs.org/docs/pages/api-reference/create-next-app) `create-next-app` ã§ Next.js ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Šã¾ã™ã€‚æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ `example-app` ã¨ã„ã†åå‰ã§ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ã«ã¯ `npm` ã‚’ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã«ã¯ `TypeScript` ã‚’æ¡ç”¨ã™ã‚‹ã‚‚ã®ã¨ã—ã¾ã™ã€‚

```
$ npx create-next-app@latest example-app --use-npm --typescript
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã„ãã¤ã‹é¸æŠè‚¢ãŒä¸ãˆã‚‰ã‚Œã‚‹ã®ã§ã€æ¬¡ã®ã‚ˆã†ã«ç­”ãˆã¾ã™ã€‚

```
âœ” Would you like to use ESLint? â€¦ No / Yes  [=> Yes]
âœ” Would you like to use Tailwind CSS? â€¦ No / Yes  [=> No]
âœ” Would you like to use `src/` directory? â€¦ No / Yes  [=> Yes]
âœ” Would you like to use App Router? (recommended) â€¦ No / Yes  => [=> Yes]
âœ” Would you like to customize the default import alias? â€¦ No / Yes  => [=> No]
```

ã¨ã“ã‚ã§ `create-next-app` ã‚³ãƒãƒ³ãƒ‰ã¯ `--example` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡å®šã§ãã¾ã™ã€‚[ã—ã‹ã—é¸æŠè‚¢ãŒå¤šã™ãã¦](https://github.com/vercel/next.js/tree/canary/examples)é€†ã«å¤§å¤‰ã«æ„Ÿã˜ãŸãŸã‚ã€æœ¬è¨˜äº‹ã§ã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã¨åŒæ§˜ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (ã“ã®ä¾‹ã§ã¯ `example-app`) ãŒä½œã‚‰ã‚Œã¾ã™ã€‚ãã“ã«ç§»å‹•ã—ã¦ `npm run dev` ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç«‹ã¡ä¸ŠãŒã‚Šã¾ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ http://localhost:3000 ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ Next.js ã®åˆæœŸç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ–ãƒ©ã‚¦ã‚¶ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ `src/app/page.tsx` ã®ã‚‚ã®ã§ã™ã€‚ã„ã£ãŸã‚“æœ€å°é™ã®å†…å®¹ã«æ›¸ãæ›ãˆã¾ã—ã‚‡ã†ã€‚`Home` é–¢æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

```tsx
export default function Home() {  
    return <div>Hello, world!</div>;  
}
```

ã“ã‚Œã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã¯ `Hello, world!` ã ã‘è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## Jest ãŠã‚ˆã³ React Testing Library ã®è¨­å®šã‚’ã™ã‚‹

ãƒ†ã‚¹ãƒˆã®ãŸã‚ã«å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ Jest ã§ãƒ†ã‚¹ãƒˆã‚’ã—ã¾ã™ã€‚

```
$ npm i -D jest jest-environment-jsdom @testing-library/react @testing-library/jest-dom
```

Jest ã®è¨­å®šã‚’ `jest.config.js` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«ç½®ãã¾ã™ã€‚å†…å®¹ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚

```javascript
const nextJest = require("next/jest");

const createJestConfig = nextJest({
    dir: "./",
});

const customJestConfig = {
    setupFilesAfterEnv: ['<rootDir>/setupTests.ts'],
    moduleNameMapper: {
        "^@/src/(.*)$": "<rootDir>/src/$1",
    },
    testEnvironment: "jest-environment-jsdom",
};

module.exports = createJestConfig(customJestConfig);
```

ã¾ãŸ `setupTests.ts` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«ç½®ãã¾ã™ã€‚å†…å®¹ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚

```
import '@testing-library/jest-dom/extend-expect';
```

ã“ã‚Œã§ Jest ã‚’ä½¿ã†æº–å‚™ãŒã§ãã¾ã—ãŸã€‚

æœ€åˆã®ãƒ†ã‚¹ãƒˆã¨ã—ã¦ `src/app` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« `Home.spec.tsx` ã‚’ä½œã‚Šã¾ã™ã€‚å†…å®¹ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚

```tsx
import { render, screen } from "@testing-library/react";
import Home from "@/app/page";

describe("Home", () => {
    it("shows 'Hello, world!'", () => {
        render(<Home />)

        expect(screen.getByText("Hello, world!")).toBeInTheDocument();
    });
});
```

ã“ã“ã¾ã§ã®è¨­å®šãŒã§ãã¦ã„ã‚Œã° `jest` ã‚³ãƒãƒ³ãƒ‰ãŒãã¡ã‚“ã¨å‹•ãã¾ã™ã€‚

```
$ jest
 PASS  src/app/Home.spec.tsx
  Home
    âœ“ shows 'Hello, world!' (21 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.248 s
Ran all test suites.
```

## ESLint ãŠã‚ˆã³ Prettier ã®è¨­å®šã‚’ã™ã‚‹ 

ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’æ•´ãˆã‚‹ãŸã‚ ESLint ã¨ Prettier ã®è¨­å®šã‚’ã—ã¾ã™ã€‚ã¾ãšã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
$ npm i -D prettier eslint-config-prettier
```

æ¬¡ã« `package.json` ã« ESLint ã®è¨­å®šã‚’å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

```json
  "eslintConfig": {
    "settings": {
      "import/parsers": {
        "@typescript-eslint/parser": [
          ".ts",
          ".tsx"
        ]
      },
      "import/resolver": {
        "typescript": {}
      },
      "parserOptions": {
        "project": "./tsconfig.json"
      }
    }
  }
```

ã“ã‚Œã§ `eslint --ext .js,.jsx,.ts,.tsx src/ --fix && prettier --write src/**/*.ts*` ã§ ESLint ã¨ Prettier ã§ã‚³ãƒ¼ãƒ‰ã®æ•´å½¢ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚å¿…è¦ã«å¿œã˜ã¦ `package.json` ã§ `npm` ã®ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦è¨­å®šã—ãŸã‚Šã€IDE ã®ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜æ™‚ã®ãƒ•ãƒƒã‚¯ã¨ã—ã¦æŒ‡å®šã™ã‚‹ã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚
